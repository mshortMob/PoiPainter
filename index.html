<html>
	<head>
		<title>FlowMapper</title>
		<style>
			body{
			    margin:0px;
				background-color:black;
			}	
			canvas{
				width:23.3%;
				height:100%;
				border-color:grey;
				border-width:thick;
				border-style: solid;
				margin-right:0px;
				margin-left:0px;
				position:relative;
			}
		</style>
	</head>
	<body>
		<canvas id="slider1" onmousedown="selectedSlider=this.id;drawSliderPosition(this.id, mouseheight);" onmouseup="selectedSlider='';" ></canvas>
		<canvas id="slider2" onmousedown="selectedSlider=this.id;drawSliderPosition(this.id, mouseheight);" onmouseup="selectedSlider='';" ></canvas>
		<canvas id="slider3" onmousedown="selectedSlider=this.id;drawSliderPosition(this.id, mouseheight);" onmouseup="selectedSlider='';" ></canvas>
		<canvas id="slider4" onmousedown="selectedSlider=this.id;drawSliderPosition(this.id, mouseheight);" onmouseup="selectedSlider='';" ></canvas>
	</body>
	<script>

		var selectedSlider="";
		function drawSliderPosition(sliderId, percentToFill){
			var c = document.getElementById(sliderId);
			var ctx = c.getContext("2d");
			ctx.clearRect(0, 0, c.width, c.height);
			ctx.beginPath();
			ctx.fillStyle = "lightgrey";
			ctx.rect(0, c.height-c.height*percentToFill, c.width, c.height*percentToFill);
			ctx.fill();
			sliderValues[sliderId]=parseInt(255*percentToFill);
			writeDMX();
		}

		var mouseheight=0;
		document.onmousemove=function(mouseevent){
			mouseheight=1-(mouseevent.clientY/window.innerHeight);
			if(selectedSlider!=""){
				drawSliderPosition(selectedSlider, mouseheight);
			}
		}

		function writeDMX() {
			xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
					console.log("Send DMX: "+this.responseText);
				}
			};
			xhttp.open("POST","proxy/set_dmx", true);
            xhttp.setRequestHeader("accept", "*/*");
            xhttp.setRequestHeader("accept-language", "en-US,en;q=0.9,und;q=0.8");
            xhttp.setRequestHeader("cache-control", "no-cache");
            xhttp.setRequestHeader("content-type", "application/x-www-form-urlencoded;charset=UTF-8");
            xhttp.setRequestHeader("pragma", "no-cache" );
			xhttp.send("u=3&d="+sliderValues["slider1"]+","+sliderValues["slider2"]+","+sliderValues["slider3"]+","+sliderValues["slider4"]);
		}
		setInterval(writeDMX,1000);
		
	</script>
</html>
